/**
* @license
*
* Regression.JS - Regression functions for javascript
* http://tom-alexander.github.com/regression-js/
*
* copyright(c) 2013 Tom Alexander
* Licensed under the MIT license.
*
* This copy is a fork created by Chase Lewis and hosted @ https://github.com/ChaseLewis/regression-js
* @module regression - Least-squares regression functions for JavaScript
**/
function BIC(n,t,i){return t+t*Math.log(2*Math.PI)+t*Math.log(n/t)+Math.log(t)*(i+1)}(function(n,t){return typeof define=="function"&&define.amd?define("regression",t):typeof module!="undefined"?module.exports=t():n.regression=t()})(this,function(){"use strict";function t(n,t,i){var u=n.reduce(function(n,t){return n+t[1]},0),f=u/n.length,e=n.reduce(function(n,t){var i=t[1]-f;return n+i*i},0),r=n.reduce(function(n,i,r){var f=t[r],u=i[1]-f[1];return n+u*u},0);return{r2:1-r/e,bic:BIC(r,n.length,i)}}function i(n,t){for(var u=0,i=0,r=0,e=0,o=0,f=n.length-1,s=new Array(t),u=0;u<f;u++){for(e=u,i=u+1;i<f;i++)Math.abs(n[u][i])>Math.abs(n[u][e])&&(e=i);for(r=u;r<f+1;r++)o=n[r][u],n[r][u]=n[r][e],n[r][e]=o;for(i=u+1;i<f;i++)for(r=f;r>=u;r--)n[r][i]-=n[r][u]*n[u][i]/n[u][u]}for(i=f-1;i>=0;i--){for(o=0,r=i+1;r<f;r++)o+=n[r][i]*s[r];s[i]=(n[f][i]-o)/n[i][i]}return s}function n(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i}var r=2,u={auto:function(n,t,i){var u=[{type:"linear"},{type:"polynomial",order:2},{type:"polynomial",order:3},{type:"polynomial",order:4},{type:"exponential"},{type:"logarithmic"}],f,r,e;for(t&&(u=t),r=0;r<u.length;r++)e=this[u[r].type](n,u[r].order,i),(!f||f.bic>e.bic)&&(f=e);return f},linear:function(i,r,u){for(var l,f=[0,0,0,0,0],c,o,h,s=i.length,e=0;e<s;e++)i[e][1]!==null&&(f[0]+=i[e][0],f[1]+=i[e][1],f[2]+=i[e][0]*i[e][0],f[3]+=i[e][0]*i[e][1],f[4]+=i[e][1]*i[e][1]);return o=(s*f[3]-f[0]*f[1])/(s*f[2]-f[0]*f[0]),h=f[1]/s-o*f[0]/s,c=i.map(function(n){var t=n[0];return[t,o*t+h]}),l=t(i,c,2),{r2:l.r2,bic:l.bic,predict:function(n){return this.equation[0]*n+this.equation[1]},equation:[o,h],points:c,string:"y = "+n(o,u.precision)+"x + "+n(h,u.precision)}},linearthroughorigin:function(i,r,u){for(var h,e=[0,0],o,s,f=0;f<i.length;f++)i[f][1]!==null&&(e[0]+=i[f][0]*i[f][0],e[1]+=i[f][0]*i[f][1]);return o=e[1]/e[0],s=i.map(function(n){var t=n[0];return[t,o*t]}),h=t(i,s,1),{r2:h.r2,bic:h.bic,predict:function(n){return this.equation[0]*n},equation:[o],points:s,string:"y = "+n(o,u.precision)+"x"}},exponential:function(i,r,u){for(var l,f=[0,0,0,0,0,0],h,o,s,c,e=0;e<i.length;e++)i[e][1]!==null&&(f[0]+=i[e][0],f[1]+=i[e][1],f[2]+=i[e][0]*i[e][0]*i[e][1],f[3]+=i[e][1]*Math.log(i[e][1]),f[4]+=i[e][0]*i[e][1]*Math.log(i[e][1]),f[5]+=i[e][0]*i[e][1]);return h=f[1]*f[2]-f[5]*f[5],o=Math.exp((f[2]*f[3]-f[5]*f[4])/h),s=(f[1]*f[4]-f[5]*f[3])/h,c=i.map(function(n){var t=n[0];return[t,o*Math.exp(s*t)]}),l=t(i,c,2),{r2:l.r2,bic:l.bic,predict:function(n){return this.equation[0]*Math.exp(this.equation[1]*n)},equation:[o,s],points:c,string:"y = "+n(o,u.precision)+"e^("+n(s,u.precision)+"x)"}},logarithmic:function(i,r,u){for(var l,f=[0,0,0,0],s,o,c,h=i.length,e=0;e<h;e++)i[e][1]!==null&&(f[0]+=Math.log(i[e][0]),f[1]+=i[e][1]*Math.log(i[e][0]),f[2]+=i[e][1],f[3]+=Math.pow(Math.log(i[e][0]),2));return o=(h*f[1]-f[2]*f[0])/(h*f[3]-f[0]*f[0]),s=(f[2]-o*f[0])/h,c=i.map(function(n){var t=n[0];return[t,s+o*Math.log(t)]}),l=t(i,c,2),{r2:l.r2,bic:l.bic,predict:function(n){return this.equation[0]+this.equation[1]*Math.log(n)},equation:[s,o],points:c,string:"y = "+n(s,u.precision)+" + "+n(o,u.precision)+" ln(x)"}},power:function(i,r,u){for(var l,f=[0,0,0,0],s,o,c,h=i.length,e=0;e<h;e++)i[e][1]!==null&&(f[0]+=Math.log(i[e][0]),f[1]+=Math.log(i[e][1])*Math.log(i[e][0]),f[2]+=Math.log(i[e][1]),f[3]+=Math.pow(Math.log(i[e][0]),2));return o=(h*f[1]-f[2]*f[0])/(h*f[3]-f[0]*f[0]),s=Math.exp((f[2]-o*f[0])/h),c=i.map(function(n){var t=n[0];return[t,s*Math.pow(t,o)]}),l=t(i,c,2),{r2:l.r2,bic:l.bic,predict:function(n){return this.equation[0]*Math.pow(n,this.equation[1])},equation:[s,o],points:c,string:"y = "+n(s,u.precision)+"x^"+n(o,u.precision)}},polynomial:function(r,u,f){for(var k=[],l=[],a=0,v=0,y,c,o,d=r.length,p,s,w,b,h=typeof u=="undefined"?3:u+1,e=0;e<h;e++){for(o=0;o<d;o++)r[o][1]!==null&&(a+=Math.pow(r[o][0],e)*r[o][1]);for(k.push(a),a=0,y=[],c=0;c<h;c++){for(o=0;o<d;o++)r[o][1]!==null&&(v+=Math.pow(r[o][0],e+c));y.push(v);v=0}l.push(y)}for(l.push(k),s=i(l,h),p=r.map(function(n){var t=n[0],i=s.reduce(function(n,i,r){return n+i*Math.pow(t,r)},0);return[t,i]}),w="y = ",e=s.length-1;e>=0;e--)w+=e>1?n(s[e],f.precision)+"x^"+e+" + ":e===1?n(s[e],f.precision)+"x + ":n(s[e],f.precision);return b=t(r,p,u+1),{r2:b.r2,bic:b.bic,predict:function(n){for(var t=0,i=this.equation.length-1;i>=0;i--)t*=n,t+=this.equation[i];return t},equation:s,points:p,string:w}},lastvalue:function(i,r,u){for(var s,e=[],o=null,f=0;f<i.length;f++)i[f][1]!==null&&isFinite(i[f][1])?(o=i[f][1],e.push([i[f][0],i[f][1]])):e.push([i[f][0],o]);return s=t(i,e,1),{r2:s.r2,bic:s.bic,predict:function(){return equation[0]},equation:[o],points:e,string:""+n(o,u.precision)}}};return function(n,t,i,f){var e=typeof i=="object"&&typeof f=="undefined"?i:f||{};return(e.precision||(e.precision=r),typeof n=="string")?u[n.toLowerCase()](t,i,e):null}});